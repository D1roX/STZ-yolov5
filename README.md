# STZ-yolov5
## Параметры обучения
1.	Data set:
  + Рекомендуемое количество изображений на 1 класс начинается от 1500
  + Необходимо разнообразие изображений для реальных случаев использования по типу разного освещения, разной погоды или времен года (если объект используется на улице), разных ракурсов, разных источников (необходимо снимать объект с разных камер для полностью своего набора данных ли брать частично с интернета) и т.д.
  + Label consistency (согласованность этикеток) – все экземпляры классов должны быть помечены. При частичной маркировке могут возникнуть ошибки в обучении (например на изображении 2 ручки а помечена только одна)
  + В наборе данных нужны фоновые изображения – изображения, на которых нет объектов для обучения. Количество таких изображений не должно превышать 10% (том же COCO их около 1%). Для фоновых изображений не требуется никаких меток
2.	Epoch – обучение нейронной сети со всему обещающими данными за один цикл, поскольку для каждого набора данных количество эпох может отличаться, их лучше всего устанавливать экспериментально начиная с 300. Далее, если не происходит переобучения, их количество можно увеличить до 600, 1200 и т.д.
3.	Batch – количество обучающих выборок или примеров за одну итерацию. Чем меньше размер пакета, тем больше нужно памяти. Также маленькие размеры приводят к плохой статистике batchnorm и их следует избегать 
4.	Img – в большинстве рекомендуемых случаях используют размер который кратный 64, но выставлять слишком маленький размер не рекомендуется.
5.	Hyperparameter – при должном опыте работы с нейросетями их можно настраивать вручную под конкретную задачу, в противном случае их необходимо эволюционировать 
6.	Network Architecture – yolov5 позволяет выбрать свою архитектуру сети с вашими персональными настройками, но для начала рекомендуется использовать одну из предложенных стандартных 
7.	mAP(средняя точность) – среднее значение AP для нескольких loU(измеряет перекрытие между двумя областями, для некоторых наборов данных предопределяется некий порог например 0.5, и это используется для классификации предсказания(true/false)), для COCO AP это среднее значение по 10 уровням loU по 80 категориям от 0.5 до 0.95 с размером шага 0.05.
8.	Precision & recall
  + Precision измеряет, насколько точны ваши предсказания. Например, какой процент ваших предсказаний корректен.
  + Recall измеряет, насколько хорошо вы находите все положительные образцы. Например, мы можем находить 80% от всех возможных положительных случаев в наших К лучших предсказаниях.

## Результаты обучения
### Нормальный датасет (New normal dataset)
#### 448 px 10 batch 900 epoch
1. obj_loss
![obj_loss](https://user-images.githubusercontent.com/86681516/162638034-56d4a3ce-8af0-4137-8954-c1b750eef164.png)
2. box_loss
![box_loss](https://user-images.githubusercontent.com/86681516/162638028-302fb1c2-8c9d-4f86-8de8-2f601f3bb85f.png)
3. cls_loss
![cls_loss](https://user-images.githubusercontent.com/86681516/162638029-f41e8b20-ff6e-4538-a062-aa7e98440d34.png)
4. mAP 0,5 - 0,95
![mAP 0,5 - 0,95](https://user-images.githubusercontent.com/86681516/162638030-2f5cc349-2d46-4298-96eb-1c4a658775e8.png)
5. mAP 0,5
![mAP 0,5](https://user-images.githubusercontent.com/86681516/162638031-11e71142-d76b-4233-a4fd-1b6518c9509e.png)
6. metrics precision
![metrics precision](https://user-images.githubusercontent.com/86681516/162638032-f361c80e-aa5f-4847-ad2c-da370e8ef792.png)
7. metric recall
![metrics recall](https://user-images.githubusercontent.com/86681516/162638228-ec1a4d31-45aa-44fd-8979-e4db6a9f550b.png)

#### 448 px 16 batch 1200 epoch
1. obj_loss
![obj_loss](https://user-images.githubusercontent.com/86681516/162638151-fd457d8b-4892-43e8-955d-28aa8aa1fa06.png)
2. box_loss
![box_loss](https://user-images.githubusercontent.com/86681516/162638153-83770b95-e61c-4311-ab3e-e505e2be2562.png)
3. cls_loss
![cls_loss](https://user-images.githubusercontent.com/86681516/162638154-caac6aa3-1b0c-48da-a44f-e8d765ff8a19.png)
4. mAP 0,5 - 0,95
![mAP 0,5 - 0,95](https://user-images.githubusercontent.com/86681516/162638155-2b163c29-e5bb-4ca7-ad90-4ca7f6ff66bc.png)
5. mAP 0,5
![mAP 0,5](https://user-images.githubusercontent.com/86681516/162638156-a7cf1c83-8262-4f18-9ede-ddbf5773a5f0.png)
6. metrics precision
![metrics precision](https://user-images.githubusercontent.com/86681516/162638158-09f44350-866b-4731-8dbc-126d4592c381.png)
7. metrics recall
![metrics recall](https://user-images.githubusercontent.com/86681516/162638160-e9f20283-a3b1-4ac2-977a-b22df779536d.png)
